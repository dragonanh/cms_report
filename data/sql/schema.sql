CREATE TABLE flash_sale_log (id BIGINT AUTO_INCREMENT, msisdn VARCHAR(255), app_code VARCHAR(255), flash_sale_id VARCHAR(255), pack_code VARCHAR(255), serial VARCHAR(255), tran_id VARCHAR(255), register_status VARCHAR(255), processed VARCHAR(255), card_price VARCHAR(255), amount VARCHAR(255), base_price VARCHAR(50), error_code VARCHAR(50), error_message VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE merchant_order (id BIGINT AUTO_INCREMENT, transaction_id VARCHAR(255) COMMENT 'Ma don hang', sub_id VARCHAR(255) COMMENT 'Ma dinh danh khach hang', merchant_code VARCHAR(50) COMMENT 'Ma doi tac', myvt_account VARCHAR(50) COMMENT 'tai khoan dang nhap myviettel', order_time datetime COMMENT 'thoi gian dat hang', status VARCHAR(50) COMMENT 'trang thai don hang', payment_status VARCHAR(50) COMMENT 'trang thai thanh toan', order_code VARCHAR(255) COMMENT 'Ma don hang', customer_name VARCHAR(50) COMMENT 'Ten Khach hang', customer_phone VARCHAR(50) COMMENT 'SDT khach hang', base_price BIGINT COMMENT 'Gia goc', price BIGINT COMMENT 'Gia thuc te thanh toan', product_name VARCHAR(255) COMMENT 'Ten san pham', quantity VARCHAR(50) COMMENT 'so luong', product_price VARCHAR(255) COMMENT 'Gia san pham', category VARCHAR(255) COMMENT 'Hinh thuc thanh toan', discount VARCHAR(50) COMMENT 'Hinh thuc thanh toan', discount_price BIGINT COMMENT 'Hinh thuc thanh toan', is_done INT COMMENT 'Hinh thuc thanh toan', processed INT COMMENT 'Hinh thuc thanh toan', trans_type_id VARCHAR(50) COMMENT 'Hinh thuc thanh toan', hold_fee VARCHAR(50) COMMENT 'Hinh thuc thanh toan', pay_gate_fee VARCHAR(50) COMMENT 'Hinh thuc thanh toan', discount_real VARCHAR(50) COMMENT 'Hinh thuc thanh toan', content LONGTEXT COMMENT 'Hinh thuc thanh toan', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE partner_refund_log (id BIGINT AUTO_INCREMENT, tran_id VARCHAR(255) COMMENT 'Ma don hang', refund_amount BIGINT COMMENT 'So tien hoan', refund_type SMALLINT COMMENT '(0: hoan toan phan, 1: hoan 1 phan)', reason LONGTEXT COMMENT 'ly do hoan tien', username VARCHAR(255) COMMENT 'usser hoan tien', ip VARCHAR(50) COMMENT 'ip thuc hien hoan tien', file_path VARCHAR(255) COMMENT 'dương dan file bb xac nhan hoan tien', viettelid_point VARCHAR(100) COMMENT 'diem viettel ++', pay_code VARCHAR(50) COMMENT 'Hinh thuc thanh toan', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE partner_transaction (id BIGINT AUTO_INCREMENT, transaction_id VARCHAR(255) COMMENT 'Mã giao dịch do viettel tự sinh', description VARCHAR(255) COMMENT 'Mô tả giao dịch', myviettel_account VARCHAR(50) COMMENT 'Số điện thoại lấy dựa theo trường sub_id', msisdn VARCHAR(50) COMMENT 'số điện thoại thực hiện thanh toán bằng điểm viettel++', status SMALLINT COMMENT 'Trạng thái giao dịch 1: trừ điểm hoặc trừ tiền thành công', merchant_code VARCHAR(50) COMMENT 'Mã đối tác', order_code VARCHAR(255) COMMENT 'Mã đơn hàng của đối tác', amount BIGINT COMMENT 'Tổng tiền phải thanh toán', base_price BIGINT COMMENT 'Số tiền đơn hàng của đối tác', pay_code VARCHAR(50) COMMENT 'Mã hình thức thanh toán', vt_transaction_id VARCHAR(255) COMMENT 'transaction_id khi đối tác vào từ webview tích hợp trên myviettel', sub_id VARCHAR(255) COMMENT 'sub_id khi đối tác vào từ webview tích hợp trên myviettel', url_redirect LONGTEXT COMMENT 'Lưu thông tin url redirect', request_id VARCHAR(255) COMMENT 'Mã giao dịch của cổng thanh toán trả về', refund_status SMALLINT COMMENT 'Trạng thái hoàn tiền( 1: chờ xác nhận hoàn tiền, 2: hoàn tiền thành công, 3: hoàn tiền thất bại)', refund_reason LONGTEXT COMMENT 'Lý do hoàn tiền', refund_time datetime COMMENT 'Thời gian hoàn tiền', refund_amount BIGINT COMMENT 'Số tiền hoàn', ip VARCHAR(50) COMMENT 'Địa chỉ ip gọi vào', status_call_api VARCHAR(2) COMMENT '00: thành công, còn lại là thất bại', payment_source VARCHAR(255) COMMENT 'Nguồn tiền thanh toán', viettelid_point VARCHAR(255), status_viettel_id SMALLINT COMMENT 'Trạng thái trừ điểm', refund_viettel_id SMALLINT COMMENT 'Trạng thái giao dịch 1: Trạng thái hoàn điểm', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sessions_admin (sess_id VARCHAR(64), sess_data LONGTEXT NOT NULL, sess_time BIGINT NOT NULL, sess_userid BIGINT, PRIMARY KEY(sess_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_area (id BIGINT AUTO_INCREMENT, code VARCHAR(255) COMMENT 'Ma code', parent_code VARCHAR(255) COMMENT 'Ma code cua thang cha', name VARCHAR(255) COMMENT 'Ten', full_name VARCHAR(255) COMMENT 'Ten day du', status SMALLINT COMMENT 'Trang thai', province VARCHAR(255) COMMENT 'Tinh thanh', district VARCHAR(50) COMMENT 'Quan huyen', precinct VARCHAR(255) COMMENT 'Phuong xa', street_block VARCHAR(50) COMMENT 'To thon', street VARCHAR(50) COMMENT 'Duong', province_name BIGINT COMMENT 'Ten tinh thanh', district_name BIGINT COMMENT 'Ten qan huyen', precinct_name VARCHAR(255) COMMENT 'Ten to thon', PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_ctt_refund_log (id BIGINT AUTO_INCREMENT, tran_id VARCHAR(255) COMMENT 'Ma don hang', refund_amount BIGINT COMMENT 'So tien hoan', refund_type SMALLINT COMMENT '(0: hoan toan phan, 1: hoan 1 phan)', reason LONGTEXT COMMENT 'ly do hoan tien', username VARCHAR(255) COMMENT 'usser hoan tien', ip VARCHAR(50) COMMENT 'ip thuc hien hoan tien', file_path VARCHAR(255) COMMENT 'dương dan file bb xac nhan hoan tien', status INT COMMENT 'Trang thai gui hoan tien', message LONGTEXT COMMENT 'Mo ta loi', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_ctt_transaction (id BIGINT AUTO_INCREMENT, calling VARCHAR(50) COMMENT 'So dien thoai thanh toan', isdn BIGINT COMMENT 'so dien thoai thu huong', tran_id VARCHAR(255) COMMENT 'Ma giao dich ben myviettel tu sinh', amount BIGINT NOT NULL COMMENT 'So tien can thanh toan', version VARCHAR(50) COMMENT 'version cua cong thanh toan', description VARCHAR(255) COMMENT 'Noi dung thanh toan', service_pay VARCHAR(255) COMMENT '(mps: gói vas, vtfree: gói vtfree, topup, omi: nghiệp vụ omi, data: gói data)', ctt_package VARCHAR(255) COMMENT 'tên gói cước (trường hợp mua gói vas, data, vtfree)', command_code BIGINT DEFAULT 0 COMMENT 'mã chu kỳ đối với gói vas', content LONGTEXT COMMENT 'dạng json lưu thông tin đơn hàng với loại mua sim ', omni_order_code VARCHAR(255) COMMENT 'mã đơn hàng với các nghiệp vụ omi', omni_error_code VARCHAR(255) COMMENT 'Ma loi khi dat hang', omni_order_message VARCHAR(255) COMMENT 'Ma loi khi dat hang', ctt_id VARCHAR(255) COMMENT 'id giao dịch bên ctt, trả về trong payRessult', status SMALLINT COMMENT 'trạng thái giao dịch thanh toán -1: thanh toán pending, 0: thanh toán thất bại, 1: thanh toán thành công, 2: hoàn tiền thành công, 3: hoàn tiền thất bại', ctt_pay_update_time datetime COMMENT 'thời gian cập nhật kết quả', source VARCHAR(255) COMMENT 'APP,WEB,WAP', order_type SMALLINT COMMENT 'loại giao dịch (1: prepaid, 2: postpaid, 21: register vas, 22: register data, 23: register vtfree, 24: topup)', ctt_package_name VARCHAR(255) COMMENT 'Ten goi cuoc dang ky', sim_number VARCHAR(50) COMMENT 'So sim dang ky mua', base_price BIGINT COMMENT 'Gia goc', service_indicator VARCHAR(10) COMMENT 'dung de truyen sang ws gach no', refund_error_code VARCHAR(45) COMMENT 'Ma loi hoan tien', channel VARCHAR(255) DEFAULT '0' COMMENT 'Kênh dich vụ tích hợp vào thanh toán', refund_status SMALLINT DEFAULT 0 COMMENT 'Trạng thái hoàn tiền', bank_code VARCHAR(50) COMMENT 'Nguon tien', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tran_id_idx (tran_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_omni_order_his (id BIGINT AUTO_INCREMENT, order_code VARCHAR(50) COMMENT 'Ma don hang', msisdn BIGINT COMMENT 'So dien thoai', error_code BIGINT COMMENT '(0: thanh cong, 1: that bai)', response LONGTEXT COMMENT 'response tra ve tu ws khi dat hang', order_content LONGTEXT COMMENT 'thong tin don hang', source VARCHAR(20) COMMENT 'APP,WEB,WAP', order_type VARCHAR(255) COMMENT 'Loại đơn hàng: 1- Đấu nối sim trả trước, 2- trả sau,..', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_payment_debt (id BIGINT AUTO_INCREMENT, base_price BIGINT, status VARCHAR(50), title VARCHAR(255), channel_code VARCHAR(255), utm_source VARCHAR(255), utm_medium VARCHAR(255), aff_sid VARCHAR(255), channel_id VARCHAR(255), channel_name VARCHAR(255), channel_type VARCHAR(255), staff_code VARCHAR(255), hotline VARCHAR(255), fb_app_id VARCHAR(255), price BIGINT, transaction_id VARCHAR(255) COMMENT 'Ma giao dich ben myviettel tu sinh', contract_id VARCHAR(50), payment_status VARCHAR(50) COMMENT 'Trang thai thanh toan', paid_status VARCHAR(50) COMMENT 'Trang thai tra phi BH', debt_begin BIGINT COMMENT 'No đau ky', service_type VARCHAR(255) COMMENT 'Loai dich vu', customer_name VARCHAR(255) COMMENT 'Ten KH', content VARCHAR(255), msisdn VARCHAR(50), order_type VARCHAR(255), register_url VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_user_signin_lock (id BIGINT AUTO_INCREMENT, user_name VARCHAR(255), created_time BIGINT, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE vt_vpg_transaction (id BIGINT AUTO_INCREMENT, calling VARCHAR(50) COMMENT 'So dien thoai thanh toan', isdn BIGINT COMMENT 'so dien thoai thu huong', tran_id VARCHAR(255) COMMENT 'Ma giao dich ben myviettel tu sinh', amount BIGINT NOT NULL COMMENT 'So tien can thanh toan', ctt_id VARCHAR(255) COMMENT 'id giao dịch bên ctt, trả về trong payRessult', status SMALLINT COMMENT '0: gạch nợ thất bại, 1: gạch nợ thành công', error_code VARCHAR(45) COMMENT '00: là thành công,33: timeOut,23: số điện thoại lỗi, Còn lại là lỗi không thể thanh toán trên VPG ', error_message VARCHAR(255) COMMENT 'Mo ta loi', is_refund SMALLINT DEFAULT 0 COMMENT '0 chưa hoàn tiền, 1 đã hoàn tiền (mặc định = 0)', retry SMALLINT DEFAULT 0 COMMENT 'Số lần retry giao dịch', channel VARCHAR(255) DEFAULT '0' COMMENT 'Kênh dich vụ tích hợp vào thanh toán APP,WEB,WAP', isdn_login VARCHAR(15) COMMENT 'SDT dang nhap myviettel', order_time datetime COMMENT 'thoi gian dat hang tren myviettel', service_indicator VARCHAR(10) COMMENT 'dung de truyen sang ws gach no', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX tran_id_idx (tran_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), phone VARCHAR(15), email_address VARCHAR(255) UNIQUE, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, pass_update_at DATETIME, is_lock_signin TINYINT(1), locked_time BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ENGINE = INNODB;
ALTER TABLE vt_ctt_transaction ADD CONSTRAINT vt_ctt_transaction_tran_id_vt_vpg_transaction_tran_id FOREIGN KEY (tran_id) REFERENCES vt_vpg_transaction(tran_id) ON DELETE SET NULL;
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
